{"version":3,"file":"matchTokenStream.js","names":["matchToken","token","expectShape","Array","isArray","some","singleExpectShape","Object","keys","every","key","actualValue","expectedValues","expectedValue","expectTokenStream","tokenStream","currentTokenPosition","tokenCount","length","expectedToken"],"sources":["../src/matchTokenStream.js"],"sourcesContent":["// LICENSE : MIT\r\n\"use strict\";\r\n\r\n/**\r\n * expectShape\r\n * [expectShape | expectShape]\r\n * にどれかにマッチするならtrueを返す\r\n * @param {*} token\r\n * @param {*|*[]} expectShape\r\n *  orでマッチしたい場合は配列を渡す\r\n * @returns {boolean}\r\n */\r\nfunction matchToken(token, expectShape) {\r\n    if (Array.isArray(expectShape)) {\r\n        return expectShape.some(singleExpectShape => matchToken(token, singleExpectShape));\r\n    }\r\n    return Object.keys(expectShape).every(key => {\r\n        const actualValue = token[key];\r\n        // 値は複数の場合もある\r\n        const expectedValues = Array.isArray(expectShape[key]) ? expectShape[key] : [expectShape[key]];\r\n        return expectedValues.some(expectedValue => {\r\n            return actualValue === expectedValue;\r\n        });\r\n    })\r\n}\r\n\r\nexport default function expectTokenStream(tokenStream) {\r\n    let currentTokenPosition = 0;\r\n    const tokenCount = tokenStream.length;\r\n    return (token) => {\r\n        const expectedToken = tokenStream[currentTokenPosition];\r\n        if (matchToken(token, expectedToken)) {\r\n            currentTokenPosition += 1;\r\n        } else {\r\n            // restart\r\n            currentTokenPosition = 0;\r\n        }\r\n        // match\r\n        if (currentTokenPosition === tokenCount) {\r\n            // match -> reset\r\n            currentTokenPosition = 0;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}"],"mappings":"AAAA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;EAAA;AAAA;AAAA;AASA,SAASA,UAAU,CAACC,KAAK,EAAEC,WAAW,EAAE;EACpC,IAAIC,KAAK,CAACC,OAAO,CAACF,WAAW,CAAC,EAAE;IAC5B,OAAOA,WAAW,CAACG,IAAI,CAACC,iBAAiB,IAAIN,UAAU,CAACC,KAAK,EAAEK,iBAAiB,CAAC,CAAC;EACtF;EACA,OAAOC,MAAM,CAACC,IAAI,CAACN,WAAW,CAAC,CAACO,KAAK,CAACC,GAAG,IAAI;IACzC,IAAMC,WAAW,GAAGV,KAAK,CAACS,GAAG,CAAC;IAC9B;IACA,IAAME,cAAc,GAAGT,KAAK,CAACC,OAAO,CAACF,WAAW,CAACQ,GAAG,CAAC,CAAC,GAAGR,WAAW,CAACQ,GAAG,CAAC,GAAG,CAACR,WAAW,CAACQ,GAAG,CAAC,CAAC;IAC9F,OAAOE,cAAc,CAACP,IAAI,CAACQ,aAAa,IAAI;MACxC,OAAOF,WAAW,KAAKE,aAAa;IACxC,CAAC,CAAC;EACN,CAAC,CAAC;AACN;AAEe,SAASC,iBAAiB,CAACC,WAAW,EAAE;EACnD,IAAIC,oBAAoB,GAAG,CAAC;EAC5B,IAAMC,UAAU,GAAGF,WAAW,CAACG,MAAM;EACrC,OAAQjB,KAAK,IAAK;IACd,IAAMkB,aAAa,GAAGJ,WAAW,CAACC,oBAAoB,CAAC;IACvD,IAAIhB,UAAU,CAACC,KAAK,EAAEkB,aAAa,CAAC,EAAE;MAClCH,oBAAoB,IAAI,CAAC;IAC7B,CAAC,MAAM;MACH;MACAA,oBAAoB,GAAG,CAAC;IAC5B;IACA;IACA,IAAIA,oBAAoB,KAAKC,UAAU,EAAE;MACrC;MACAD,oBAAoB,GAAG,CAAC;MACxB,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB,CAAC;AACL"}