{"version":3,"file":"rule-define.js","names":["PRONOUN_TABLE","forbidden_form","preferred_form","ADVERB_TABLE","NOUN_TABLE","findForbidden","surface_form","formTable","i","length","isContainsKanji","val","regexp","test","convertKanaToHira","str","replace","match","chr","charCodeAt","String","fromCharCode","context","RuleError","fixer","matchPattern代名詞漢字書き","matchTokenStream","matchPattern副詞漢字書き","matchPattern接続詞かな書き","matchPattern感動詞かな書き","matchPattern名詞送り仮名","token","forbbidenExist","undefined","index","word_position","fix","replaceTextRange","kanjiFlag","pronunciation"],"sources":["../../src/rules/rule-define.js"],"sourcesContent":["// LICENSE : MIT\r\n\"use strict\";\r\n/*\r\n    (f) 接続詞かな書き\r\n*/\r\nimport matchTokenStream from \"./../matchTokenStream\";\r\n\r\nconst PRONOUN_TABLE = [\r\n    {\r\n        forbidden_form: \"わたし\",\r\n        preferred_form: \"私\"\r\n    },\r\n    {\r\n        forbidden_form: \"かれ\",\r\n        preferred_form: \"彼\"\r\n    }\r\n];\r\n\r\nconst ADVERB_TABLE = [\r\n    {\r\n        forbidden_form: \"さらに\",\r\n        preferred_form: \"更に\"\r\n    },\r\n    {\r\n        forbidden_form: \"すでに\",\r\n        preferred_form: \"既に\"\r\n    }\r\n];\r\n\r\nconst NOUN_TABLE = [\r\n    {\r\n        forbidden_form: \"打ち合わせ\",\r\n        preferred_form: \"打合せ\"\r\n    },\r\n    {\r\n        forbidden_form: \"受け付け\",\r\n        preferred_form: \"受付\"\r\n    }\r\n];\r\n\r\n/**\r\n * Find the forbidden particle from the user-defined table.\r\n * If exists return the preferred form, else return null.\r\n *\r\n * @param {string} surface_form surface_form in kuromojin.\r\n * @param {Object} formTable\r\n * @return {object} Object contains forbidden_form&preferred_form.\r\n */\r\nfunction findForbidden(surface_form, formTable){\r\n    for(var i = 0; i < formTable.length; i++){\r\n        if(surface_form == formTable[i][\"forbidden_form\"]){\r\n            return formTable[i];\r\n        }\r\n    }\r\n    return;\r\n};\r\n\r\n/**\r\n * Check whether the given string contains kanji characters.\r\n *\r\n * @param {string} val The text to be valuated.\r\n * @return {boolean} True: yes, False, no.\r\n */\r\nfunction isContainsKanji(val) {\r\n    var regexp = /([\\u{3005}\\u{3007}\\u{303b}\\u{3400}-\\u{9FFF}\\u{F900}-\\u{FAFF}\\u{20000}-\\u{2FFFF}][\\u{E0100}-\\u{E01EF}\\u{FE00}-\\u{FE02}]?)/mu;\r\n    return regexp.test(val);\r\n};\r\n\r\n/**\r\n * Convert katakana to hiragana for the given string.\r\n *\r\n * @param {string} str The text to be converted.\r\n * @return {string} Hiragana string.\r\n */\r\nfunction convertKanaToHira(str) {\r\n    return str.replace(/[\\u30a1-\\u30f6]/g, function(match) {\r\n        var chr = match.charCodeAt(0) - 0x60;\r\n        return String.fromCharCode(chr);\r\n    });\r\n};\r\n\r\nexport default function (context) {\r\n    const {RuleError, fixer} = context;\r\n\r\n    const matchPattern代名詞漢字書き = matchTokenStream([\r\n        {\r\n            \"pos\": \"名詞\",\r\n            \"pos_detail_1\": \"代名詞\"\r\n        }\r\n    ]);\r\n\r\n    const matchPattern副詞漢字書き = matchTokenStream([\r\n        {\r\n            \"pos\": \"副詞\"\r\n        }\r\n    ]);\r\n\r\n    const matchPattern接続詞かな書き = matchTokenStream([\r\n        {\r\n            \"pos\": \"接続詞\"\r\n        }\r\n    ]);\r\n\r\n    const matchPattern感動詞かな書き = matchTokenStream([\r\n        {\r\n            \"pos\": \"感動詞\"\r\n        }\r\n    ]);\r\n\r\n    const matchPattern名詞送り仮名 = matchTokenStream([\r\n        {\r\n            \"pos\": \"名詞\"\r\n        }\r\n    ]);\r\n\r\n    return (token) => {        \r\n        if (matchPattern代名詞漢字書き(token) == true) {\r\n            var forbbidenExist = findForbidden(token.surface_form, PRONOUN_TABLE);\r\n            if(forbbidenExist != undefined){\r\n                return new RuleError(`代名詞漢字書き: ${forbbidenExist[\"forbidden_form\"]}`, {\r\n                    index: token.word_position - 1,\r\n                    fix: fixer.replaceTextRange([token.word_position - 1, token.word_position - 1 + token.surface_form.length], forbbidenExist[\"preferred_form\"])\r\n                });\r\n            }\r\n        };\r\n        if (matchPattern副詞漢字書き(token) == true) {\r\n            var forbbidenExist = findForbidden(token.surface_form, ADVERB_TABLE);\r\n            if(forbbidenExist != undefined){\r\n                return new RuleError(`副詞漢字書き: ${forbbidenExist[\"forbidden_form\"]}`, {\r\n                    index: token.word_position - 1,\r\n                    fix: fixer.replaceTextRange([token.word_position - 1, token.word_position - 1 + token.surface_form.length], forbbidenExist[\"preferred_form\"])\r\n                });\r\n            }\r\n        };\r\n        if (matchPattern接続詞かな書き(token) == true) {\r\n            var kanjiFlag = isContainsKanji(token.surface_form)\r\n            if(kanjiFlag == true){\r\n                return new RuleError(`接続詞かな書き: ${token.surface_form}`, {\r\n                    index: token.word_position - 1,\r\n                    fix: fixer.replaceTextRange([token.word_position - 1, token.word_position - 1 + token.surface_form.length], convertKanaToHira(token.pronunciation))\r\n                });\r\n            }\r\n        };\r\n        if (matchPattern名詞送り仮名(token) == true) {\r\n            var forbbidenExist = findForbidden(token.surface_form, NOUN_TABLE);\r\n            if(forbbidenExist != undefined){\r\n                return new RuleError(`名詞送り仮名: ${forbbidenExist[\"forbidden_form\"]}`, {\r\n                    index: token.word_position - 1,\r\n                    fix: fixer.replaceTextRange([token.word_position - 1, token.word_position - 1 + token.surface_form.length], forbbidenExist[\"preferred_form\"])\r\n                });\r\n            }\r\n        };\r\n    };\r\n}"],"mappings":"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"}